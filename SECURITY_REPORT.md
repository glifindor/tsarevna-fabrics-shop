# üîí –û—Ç—á–µ—Ç –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–∞–π—Ç–∞ "–¶–∞—Ä–µ–≤–Ω–∞ –®–≤–µ—è–Ω–∞"

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**
- ‚úÖ **NextAuth.js** —Å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º Credentials
- ‚úÖ **JWT —Ç–æ–∫–µ–Ω—ã** —Å –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏ 30 –¥–Ω–µ–π
- ‚úÖ **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π** —á–µ—Ä–µ–∑ bcrypt (salt rounds: 10)
- ‚úÖ **–†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å** (user/admin)
- ‚úÖ **–ó–∞—â–∏—Ç–∞ API –º–∞—Ä—à—Ä—É—Ç–æ–≤** —á–µ—Ä–µ–∑ getServerSession()
- ‚úÖ **–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª—å—Ü—É

### 2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
- ‚úÖ **Client-side –≤–∞–ª–∏–¥–∞—Ü–∏—è** —á–µ—Ä–µ–∑ react-hook-form + Zod
- ‚úÖ **Server-side –≤–∞–ª–∏–¥–∞—Ü–∏—è** –≤–æ –≤—Å–µ—Ö API –º–∞—Ä—à—Ä—É—Ç–∞—Ö
- ‚úÖ **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞** (XSS/SQL injection –∑–∞—â–∏—Ç–∞)
- ‚úÖ **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤**
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏** email –∏ –∞—Ä—Ç–∏–∫—É–ª–æ–≤

### 3. **Rate Limiting**
- ‚úÖ **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ö–æ–¥–∞**: 5 –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ 15 –º–∏–Ω—É—Ç
- ‚úÖ **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏**: 3 –ø–æ–ø—ã—Ç–∫–∏ –∑–∞ —á–∞—Å
- ‚úÖ **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ñ–æ—Ä–º**: 3 —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞ —á–∞—Å
- ‚úÖ **–û–±—â–∏–µ API –∑–∞–ø—Ä–æ—Å—ã**: 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ –º–∏–Ω—É—Ç—É

### 4. **Security Headers**
- ‚úÖ **X-Frame-Options**: DENY (–∑–∞—â–∏—Ç–∞ –æ—Ç clickjacking)
- ‚úÖ **X-Content-Type-Options**: nosniff
- ‚úÖ **X-XSS-Protection**: –≤–∫–ª—é—á–µ–Ω–∞
- ‚úÖ **Content-Security-Policy**: –±–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ **Referrer-Policy**: origin-when-cross-origin

### 5. **–ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö**
- ‚úÖ **–ü–∞—Ä–æ–ª–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è** –≤ API –æ—Ç–≤–µ—Ç–∞—Ö
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**
- ‚úÖ **–û—á–∏—Å—Ç–∫–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** –∏–∑ –ª–æ–≥–æ–≤
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞** –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ API:
```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
const session = await getServerSession(authOptions);
if (!session) return 401;

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
if (session.user.role !== 'admin') return 403;

// –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
const validation = validateUserInput(data, 'text');
if (!validation.isValid) return 400;
```

### Rate Limiting:
```typescript
const rateLimitResult = apiRateLimit.check(ip);
if (!rateLimitResult.success) return 429;
```

### –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è:
```typescript
const sanitized = sanitizeString(userInput);
// –£–¥–∞–ª–µ–Ω–∏–µ <script>, onclick=, javascript: –∏ —Ç.–¥.
```

## üõ°Ô∏è –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã

### API –º–∞—Ä—à—Ä—É—Ç—ã —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π:
- `/api/cart/*` - –∫–æ—Ä–∑–∏–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/api/orders/*` - –∑–∞–∫–∞–∑—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/api/users/*` - –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/api/upload` - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤

### API –º–∞—Ä—à—Ä—É—Ç—ã —Å –∞–¥–º–∏–Ω—Å–∫–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏:
- `POST /api/products` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
- `PUT/DELETE /api/products/*` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
- `POST /api/categories` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- `PUT/DELETE /api/categories/*` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- `GET /api/users` - —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞ (—É—Å–ø–µ—à–Ω—ã–µ –∏ –Ω–µ—É—Å–ø–µ—à–Ω—ã–µ)
- –ü—Ä–µ–≤—ã—à–µ–Ω–∏—è rate limits
- –ü–æ–ø—ã—Ç–∫–∏ XSS/SQL injection
- –î–æ—Å—Ç—É–ø –∫ –∑–∞—â–∏—â–µ–Ω–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞:
- –û—á–∏—Å—Ç–∫–∞ expired rate limit –∑–∞–ø–∏—Å–µ–π –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP
- –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

## ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```env
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
NEXTAUTH_SECRET="—Å–ª–æ–∂–Ω—ã–π-—Å–ª—É—á–∞–π–Ω—ã–π-–∫–ª—é—á-32-—Å–∏–º–≤–æ–ª–∞"
JWT_SECRET="–¥—Ä—É–≥–æ–π-—Å–ª–æ–∂–Ω—ã–π-–∫–ª—é—á-–¥–ª—è-jwt"

# –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
DATABASE_URL="mongodb://user:pass@host:port/db"

# Telegram (–¥–ª—è —Ñ–æ—Ä–º)
TELEGRAM_BOT_TOKEN="–≤–∞—à-–±–æ—Ç-—Ç–æ–∫–µ–Ω"
TELEGRAM_CHAT_ID="–≤–∞—à-chat-id"
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞:
- ‚úÖ HTTPS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (Let's Encrypt)
- ‚úÖ Firewall –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤

### 3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä—ã:
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ fail2ban –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ IP
- –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ npm audit
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CORS –¥–ª—è API

## üö® –ß—Ç–æ –¥–µ–ª–∞—Ç—å –≤ —Å–ª—É—á–∞–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞

### –ü—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –≤–∑–ª–æ–º:
1. –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ —Å–º–µ–Ω–∏—Ç—å –≤—Å–µ –ø–∞—Ä–æ–ª–∏ –∏ —Ç–æ–∫–µ–Ω—ã
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
3. –í—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ IP
4. –£–≤–µ–¥–æ–º–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª–µ–π

### –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:
1. –û—Ü–µ–Ω–∏—Ç—å –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å
2. –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —É—è–∑–≤–∏–º—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (–µ—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ)
3. –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
4. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
5. –£–≤–µ–¥–æ–º–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ)

## üìä –°—Ç–∞—Ç—É—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: ‚úÖ –í–´–°–û–ö–ò–ô

–°–∞–π—Ç –∏–º–µ–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∑–∞—â–∏—Ç—ã, –ø–æ–∫—Ä—ã–≤–∞—é—â—É—é –æ—Å–Ω–æ–≤–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã –∞—Ç–∞–∫:
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –ó–∞—â–∏—â–µ–Ω–∞ ‚úÖ
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: –ó–∞—â–∏—â–µ–Ω–∞ ‚úÖ  
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**: –ó–∞—â–∏—â–µ–Ω–∞ ‚úÖ
- **Rate Limiting**: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω ‚úÖ
- **XSS –∑–∞—â–∏—Ç–∞**: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ ‚úÖ
- **SQL Injection**: –ó–∞—â–∏—Ç–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ ‚úÖ
- **CSRF –∑–∞—â–∏—Ç–∞**: Headers –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã ‚úÖ

---
*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: $(date)*
*–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Å–∞–π—Ç–∞* 